# Scriptable Setlist Helper

アイドル・ライブのセットリストを **ワンタップ** で下書き生成し、X（旧Twitter）アプリやブラウザへ直接投稿できる Scriptable スクリプトです。会場・曲数・曲名を対話式に選択し、ハッシュタグも JSON で自由に管理できます。

---

## 目次

1. [機能概要](#機能概要)
2. [動作環境](#動作環境)
3. [iOS でのセットアップ](#ios-でのセットアップ)
4. [導入手順](#導入手順)
5. [使い方](#使い方)
6. [JSON ファイル仕様](#json-ファイル仕様)
7. [カスタマイズ](#カスタマイズ)
8. [ライセンス](#ライセンス)

---
## 機能概要
* **日時・会場・曲数・曲名** を順に GUI で選択
* 各画面に **「← 戻る」** ボタンを実装（誤タップでも安心）
* 会場は **キーワード検索＋候補表示** 方式（大量リストでも高速）
* 会場未登録時は **空欄スキップ** 可能
* ハッシュタグを `idol-setlist.json` に外部化 → スクリプト改変不要
* 出力先は
  * X 公式アプリの投稿画面
  * Web インテント (Safari)
  * **クリップボードのみ** にも対応
---
## 動作環境

| 項目                    | 推奨バージョン                        |
| --------------------- | ------------------------------ |
| iOS / iPadOS          | **15.0 以降**（16 以上推奨）           |
| Scriptable            | **1.7.0 以降**（DatePicker クラス必須） |
| X (旧Twitter) アプリ (任意) | 最新版                            |

> ⚠️ 古い Scriptable では `DatePicker` が存在しないため、日付入力はフォールバックとして **手入力** ダイアログに切り替わります。

---

## iOS でのセットアップ
1. **Scriptable をインストール**
   App Store >「Scriptable」> **入手 / 開く**
2. **iCloud Drive を有効化**
   *設定* › *Apple ID* › *iCloud* › **iCloud Drive** → *オン*
3. **Scriptable フォルダ確認**
   Files.app › **iCloud Drive** › **Scriptable**
4. (任意) **ショートカットの信頼性設定**
   *設定* › *ショートカット* › **信頼されていないショートカットを許可** → *オン*
---

## 導入手順

以下の方法なら **パソコン不要・コピペだけ** で完了します。

### 1. スクリプト (`SetList.js`) を Scriptable に貼り付け

1. **Safari** で GitHub の `SetList.js` を開く → 右上 **Raw** をタップ。
2. 画面を長押しして **すべて選択** → **コピー**。
3. **Scriptable** アプリを開き、右上 **＋** → エディタに **ペースト**。
4. 右上 **完了** を押して保存（ファイル名は *Setlist* など自由）。

> 共有シートから「Scriptable で開く」を選べる場合は、ペースト操作すら不要です。

### 2. JSON (`setlist.json`) を iCloud Drive に保存

1. Safari で `setlist.json` を **Raw** 表示 → 長押し **すべて選択** → **コピー**。
2. **Files** アプリを開き、*iCloud Drive* › **Scriptable** フォルダへ移動。
3. 右上 **…** › **新規書類**（または「新規テキスト」）を選択。
4. ファイル名を **`idol-setlist.json`** と入力 → 作成後にエディタが開くので **ペースト** → **完了**。

> **もっと簡単** : Raw 画面で共有アイコン › **ファイルに保存** → *iCloud Drive ▸ Scriptable* に直接保存しても OK です。

### 3. 実行テスト

1. Scriptable で *Setlist* を開き、右上 **▶︎** をタップ。
2. ダイアログが順番に表示されればセットアップ完了。実行後、クリップボードに下書きがコピーされます。

---
## 使い方
1. Scriptable 内でスクリプトを実行（またはホーム画面ウィジェット化）
2. **日付 → 会場 → 曲数 → 曲** を順にタップ選択
3. 生成された下書きが表示 & クリップボードにコピー
4. 最終ダイアログで
   * **X アプリで開く**
   * **ブラウザで開く**
   * **コピーのみ**
     を選択
> **ウィジェット化** するとホーム画面から直接起動できて便利です。
---
## JSON ファイル仕様
```json
{
  "venues": ["Shibuya CLUB QUATTRO", "Zepp DiverCity(TOKYO)"],
  "songs" : ["TOKYO planet Σarth", "UNISON CUBΣ"],
  "tags"  : ["#今日のライブ", "#セットリスト"]
}
```
| キー       | 型                          | 必須 | 説明                                   |
| -------- | -------------------------- | -- | ------------------------------------ |
| `venues` | array\<string>             | ✓  | 会場名リスト（完全一致検索）                       |
| `songs`  | array\<string>             | ✓  | 楽曲名リスト                               |
| `tags`   | array\<string>  または string | ✕  | 末尾に追加するハッシュタグ群<br>省略・空の場合はタグ行を出力しません |
---
## カスタマイズ
* **Alert のリスト長** `MAX_LIST_LEN` を変更 … 大量リストでも固まらない値（10〜30 推奨）
* **ハッシュタグの出力抑制** … `tags` を空配列 `[]` に
* **曲の重複選択を許可** … スクリプト内 `songs.filter` 部分を `const pool = songs;` に変更
* **投稿アプリを増やす** … 最終ダイアログで `Safari.open()` の URL を追加
---
## ライセンス
このリポジトリは **MIT License** で公開されています。詳細は `LICENSE` ファイルを参照してください。
